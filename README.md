# Сервис по ответам на отзывы покупателей

Автоматический сервис генерации ответов на отзывы покупателей для маркетплейса Wildberries с использованием LLM (OpenAI).

## Описание

Сервис принимает отзывы пользователей, обогащает их данными о товаре и сопутствующих товарах, а затем генерирует персонализированные ответы с помощью LLM. Поддерживается пакетная обработка, интеграция с несколькими источниками данных (PostgreSQL, Greenplum, Statika, Feature Store API), а также устойчивость к сбоям и мониторинг состояния.

## Основные возможности

- Генерация ответов на отзывы с учетом информации о товаре и прошлых ответов продавца
- Пакетная обработка запросов (`/api/v1/llm/batch-chat`, `/api/v1/llm/generate-responses`)
- Интеграция с внешними БД и API для получения информации о товарах
- Кэширование и повторные попытки при ошибках
- Circuit Breaker для устойчивости к сбоям внешних сервисов
- Метрики и эндпоинты для мониторинга состояния (`/systemhealth`)

## Быстрый старт

### Требования

- Python 3.11+
- Docker (опционально)
- PostgreSQL, Greenplum, доступ к OpenAI API

### Установка

1. Клонируйте репозиторий:
   ```sh
   git clone <repo-url>
   cd review-autoresponse

2. pip install -r requirements.txt

3. Создайте файл .env на основе .env.template и заполните переменные окружения.

### API

GET /health — базовая проверка работоспособности

GET /systemhealth — расширенный статус системы

POST /api/v1/llm/batch-chat — пакетная генерация ответов (см. app/models/llm.py)

POST /api/v1/llm/generate-responses — генерация ответов на отзывы (Kafka-формат)

### Структура проекта

app/main.py — точка входа FastAPI

app/services/ — бизнес-логика и интеграции с БД/API

app/models/ — Pydantic-модели данных

app/core/ — настройки, circuit breaker, performance

app/prompts/ — шаблоны промптов для LLM

app/utils/ — утилиты (retry, очередь сообщений)

deploy/ — Dockerfile, Kubernetes-манифесты
